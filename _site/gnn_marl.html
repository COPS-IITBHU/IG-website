<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>
        Graph Attention based communication in Multi Agent RL
    </title>
    <meta
        name="description"
        content="GNN-MARL"
    />
    <link rel="stylesheet" href="http://localhost:4000/IG-website/css/main.css">
    <link
        rel="canonical"
        href="http://localhost:4000/IG-website//gnn_marl"
    />
    <link
        rel="shortcut icon"
        type="image/png"
        href="http://localhost:4000/IG-website/images/COPS icon.png"
    />

    
</head>


  <body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      

      <a class="navbar-brand" href="http://localhost:4000/IG-website/">COPS IG @ IIT BHU</a>

      </div>
  <nav id="navbar-collapse-1" class="collapse navbar-collapse">
      <ul class="nav navbar-nav navbar-right">

        

              
              
                      
                      <!--  -->
                      
                      <li class="active">
                          <a href="http://localhost:4000/IG-website/">Home</a>
                  </li>
                 
  
                      
                      <!--  -->
                      
                      <li class="active">
                          <a href="http://localhost:4000/IG-website/people">People</a>
                  </li>
                 
  
                      
                      <!--  -->
                      
                      <li class="active">
                          <a href="http://localhost:4000/IG-website/project">Projects</a>
                  </li>
                 
  
                      
                      <!--  -->
                      
                              <li class="active">
                                      <a href="http://localhost:4000/IG-website//" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Resources <span class="caret"></span></a>
                                      <ul class="dropdown-menu">
                                              
                                                      
                                                              <li>
                                                                      <a href="http://localhost:4000/IG-website/roadmap">AI Roadmap</a>
                                                              </li>
                                                      
                                              
                                                      
                                                              <li>
                                                                      <a href="http://localhost:4000/IG-website/excercise">AI Exercise</a>
                                                              </li>
                                                      
                                              
                                                      
                                                              <li>
                                                                      <a href="http://localhost:4000/IG-website/beginnersRoadmap">AI/ML/Data Science Roadmap for Beginners</a>
                                                              </li>
                                                      
                                              
                                      </ul>
                              </li>
                              
                             
  
                      
                      <!--  -->
                      
                              <li class="active">
                                      <a href="http://localhost:4000/IG-website//" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Activities <span class="caret"></span></a>
                                      <ul class="dropdown-menu">
                                              
                                                      
                                                              <li>
                                                                      <a href="http://localhost:4000/IG-website/mltalks">ML Talks</a>
                                                              </li>
                                                      
                                              
                                                      
                                                              <li>
                                                                      <a href="http://localhost:4000/IG-website/paperread">RL and multiagent systems: paper reading group</a>
                                                              </li>
                                                      
                                              
                                      </ul>
                              </li>
                      <!-- -->

                      
                               <li class="active">
                                      <a href="http://localhost:4000/IG-website//" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Blog <span class="caret"></span></a>
                                      <ul class="dropdown-menu">
                                              
                                                      
                                                              <li>
                                                                      <a href="http://localhost:4000/IG-website/blog">Inter IIT Tech Meet 10.0</a>
                                                              </li>
       
                                      </ul>
                              </li>
                              
                             
  
        <!-- <li> -->
        <!-- <button id="theme-toggle" onclick="modeSwitcher()" style="cursor: pointer;"></button> -->

        <!-- </li> -->
        <head>
                <script src="https://code.iconify.design/1/1.0.4/iconify.min.js">   </script>
              </head>
              <label>
                      
                <input class='toggle-checkbox' type='checkbox' id="theme-toggle" onclick="modeSwitcher()" {checkBox}></input>
                <div class='toggle-slot'>
                  <div class='sun-icon-wrapper'>
                    <div class="iconify sun-icon" data-icon="feather-sun" data-inline="false"></div>
                  </div>
                  <div class='toggle-button'></div>
                  <div class='moon-icon-wrapper'>
                    <div class="iconify moon-icon" data-icon="feather-moon" data-inline="false"></div>
                  </div>
                </div>
              </label>
              <script src="/IG-website/js/dark-mode.js"></script>
              
  </ul>
  </nav>
  </div>
  </div>
  

    <div class="container-fluid">
      <div class="row">
        <div id="blog" class="col-sm-12">
  <style>
    img.img-responsive {
        display: block;
        margin: 0 auto;
    }
</style>

<h3 align="center">Graph Attention based communication in Multi Agent RL</h3>
<h6 align="center"><a align="center" href="http://hex-plex.github.io/">Somnath Kumar</a></h6>

<p><a href="https://github.com/hex-plex/GNN-MARL">Code and Details</a></p>

<p>This is an implementation of Communication in MARL using Graph Neural Network. This is been trained and tested on
<a href="https://github.com/deepmind/pysc2">StarCraft II</a>, And this has shown improved training and performance metrics
throughout all the maps. I have implemented this on top of <a href="https://github.com/oxwhirl/pymarl">PyMARL</a> for easier
comparative study with respect to other algorithms or implementations like
<a href="https://github.com/uoe-agents/epymarl">ePyMARL</a>.</p>

<p>Currently we have the following algorithms for training.</p>
<ul>
  <li><a href="https://arxiv.org/abs/1803.11485"><strong>QMIX</strong>: QMIX: Monotonic Value Function Factorisation for Deep Multi-Agent Reinforcement
Learning</a></li>
  <li><a href="https://arxiv.org/abs/1705.08926"><strong>COMA</strong>: Counterfactual Multi-Agent Policy Gradients</a></li>
  <li><a href="https://arxiv.org/abs/1706.05296"><strong>VDN</strong>: Value-Decomposition Networks For Cooperative Multi-Agent Learning</a></li>
  <li><a href="https://arxiv.org/abs/1511.08779"><strong>IQL</strong>: Independent Q-Learning</a></li>
  <li><a href="https://arxiv.org/abs/1905.05408"><strong>QTRAN</strong>: QTRAN: Learning to Factorize with Transformation for Cooperative Multi-Agent Reinforcement
Learning</a></li>
</ul>

<p>For communication we have used to different Architecures</p>

<ul>
  <li><a href="https://arxiv.org/abs/1609.02907"><strong>GConv</strong>: Graph Convolutional Network</a></li>
  <li><a href="https://arxiv.org/abs/1710.10903"><strong>GAT</strong>: Graph Attention Network</a></li>
</ul>

<h3 id="graph-neural-network">Graph Neural Network.</h3>

<p>More Information about the architecture and the execution can be found at <a href="https://hex-plex.github.io/project/gnn-marl/">MultiAgent
GNN</a>
A brief outline would be as follows</p>

<p><img src="https://cops-iitbhu.github.io/IG-website//images/pubpic/gnn-marl.jpg" class="img-responsive" /></p>

<p align="center">Pipeline for communication using Graph Neural Network</p>

<p>The implementation is written in PyTorch and uses a modified version of <a href="https://github.com/oxwhirl/smac">SMAC</a> which
could be found in <a href="/smac-py/">smac-py</a> to include the adjacency matrix as the observation more detail on it can be found
<a href="#adjacency-matrix">here</a>.</p>

<p>For a glimpse of the algorithm in action checkout the <a href="#output"><strong>Output</strong></a> section</p>

<h2 id="adjacency-matrix">Adjacency Matrix</h2>

<p>An adjacency matrix simply represents the vertices of the graph. For the current problem we have used a few heuristics
for joining two nodes with a vertex. They are as below</p>
<ul>
  <li><strong>Communication distance</strong> : - Even though their is no restriction in communication having local communication
improves cooperation in shared tasks</li>
  <li><strong>Unit Type</strong> : - Many task benefit from similar units perfoming certain part of the task than other other units
cooperating with each other.</li>
</ul>

<h2 id="output">Output</h2>
<p>This is a demo output from the policy whose stats are given above
<img align="centre" src="https://raw.githubusercontent.com/hex-plex/GNN-MARL/master/media/output.gif" width="80%" class="img-responsive" /></p>

<h2 id="results">Results</h2>

<p>Below are the training and test metric of the presented algorithm with <strong>QMIX</strong> on map 2s3z. The study is limited to the
number of experiments due to limitation in computation at the disposal. The presented algorithm does support parallel
envs and boosting the process of training. This would be tested soon</p>

<table>
  <thead>
    <tr>
      <th>Train</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Battle win percentage</td>
      <td>Average Return</td>
    </tr>
    <tr>
      <td><img src="https://raw.githubusercontent.com/hex-plex/GNN-MARL/master/media/train_battle_win_percentage.png" alt="" /></td>
      <td><img src="https://raw.githubusercontent.com/hex-plex/GNN-MARL/master/media/train_return_mean.png" alt="" /></td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>Test</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Battle win percentage</td>
      <td>Average Return</td>
    </tr>
    <tr>
      <td><img src="https://raw.githubusercontent.com/hex-plex/GNN-MARL/master/media/test_battle_win_percentage.png" alt="" /></td>
      <td><img src="https://raw.githubusercontent.com/hex-plex/GNN-MARL/master/media/test_return_mean.png" alt="" /></td>
    </tr>
  </tbody>
</table>

</div>

      </div>
    </div>

    <div id="footer" class="panel">
  <div class="panel-footer">
	<div class="container-fluid">
	  <div class="row">
		<div class="col-sm-4">
			
		  <p><b>&copy 2021 COPS IG.</b>
				<br> 
				Site made with <a href="https://jekyllrb.com">Jekyll</a>;  <a href="http://localhost:4000/IG-website//aboutwebsite.html">copy and  modify it for your own research group.</a></p>
              <p>We are part of the <a href="https://www.copsiitbhu.co.in/">COPS</a> at <a href="https://www.iitbhu.ac.in/">IIT BHU</a>.</p>
            

		   <p>  </p><p>
            		  
            
		</div>
		<div class="col-sm-4">
		<!-- 
		  Funding:<br />
		  - <a href="http://www.nwo.nl/en/research-and-results/programmes/Talent+Scheme">Vidi </a> and <a href='https://www.fom.nl/en/news/press-releases/2016/11/18/28634/'>Projectruimte</a> grants from <a href="http://www.nwo.nl">NWO</a> <br />
		  - <a href="https://www.universiteitleiden.nl/en/research/research-projects/science/frontiers-of-nanoscience-nanofront">Frontier of Nanosciences</a>, a gravity program from <a href="http://www.nwo.nl">NWO</a>
          - <a href='https://www.universiteitleiden.nl/en/news/2017/08/two-erc-grants-for-leiden-physics'>ERC starting grant</a>
					-->
		</div>
		<div class="col-sm-4">
		  <b>Contact:</b><br />
		  IIT-BHU - (<a href="https://goo.gl/maps/S3JehoUudfpueRpd9">Maps</a>)<br /> 
		  Banaras Hindu University Campus<br />
		  Uttar Pradesh 221005<br />
		  India<br />
            
		</div>
	  </div>
	</div>
  </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="http://localhost:4000/IG-website/js/bootstrap.min.js"></script>


  </body>

</html>
